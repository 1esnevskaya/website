チームコラボレーションでは、全員が自分の役割と権限を明確に理解することが、スムーズな進行を確保するために不可欠です。今日は、チームワークをより効率的かつ組織的にするために、役割の作成と権限管理について学びます。

心配しないでください。このプロセスはシンプルです。重要な各ステージでガイドを提供しながら、一歩一歩進めていきます。もし問題に遭遇した場合は、どうぞお気軽に公式フォーラムにサポートを求めてください。

### 要件分析

タスク管理に参加するために、特定の権限を持つ「パートナー」という役割が必要ですが、他の人のタスクを自由に変更する権限はありません。このアプローチによって、タスクの割り当てとフレキシブルなコラボレーションが可能になります。

![役割構造図](https://static-docs.nocobase.com/Solution/WSy8bi0zOozbBKxzlimcyje4n7f.png)

> **役割と権限の紹介：** 役割と権限は、ユーザーのアクセスと操作を管理するための重要なメカニズムです。各ユーザーは複数の役割を持つことができます。
>
> 役割の権限を設定することで、システム内でのユーザーの行動や操作を制御し、表示機能の制限を設けることができます。これはアクセス制御にとって重要です。
> 役割と権限を活用してユーザーを結びつけることで、システムをより効果的に管理できます。管理者として、必要に応じて権限を割り当てたり調整したりできます。

### 6.1 **役割の作成と割り当て**

#### 6.1.1 **「パートナー」役割の作成**

- インターフェースの右上にある[「ユーザーと権限」](https://docs.nocobase.com/handbook/users)をクリックし、[「役割と権限」](https://docs.nocobase.com/handbook/acl)を選択します。ここが役割を設定し、権限を管理する場所です。
- 「**役割を作成**」ボタンをクリックすると、ダイアログボックスが表示されます。ここで役割の名前を**パートナー**とし、保存を確認します。

![](https://static-docs.nocobase.com/Solution/demov3N-28N.gif)

役割が正常に作成されました！次に、この役割に権限を割り当て、タスク管理に参加できるようにします。

#### 6.1.2 **自分に新しい役割を割り当てる**

役割の権限が正常に機能していることを確認するために、この役割をまず自分のアカウントに割り当ててテストします。以下の手順で行います：

- ユーザー管理セクションで自分のアカウントを見つけてクリックし、「**役割と権限**」を選択し、**「パートナー」**を選びます。

![](https://static-docs.nocobase.com/Solution/demov3N-29.gif)

今、自分のアカウントを使って「パートナー」役割の体験をシミュレーションできます。次に、役割を切り替える方法を見てみましょう。

#### 6.1.3 **「パートナー」役割に切り替える**

あなた自身に「パートナー」役割を割り当てましたので、役割を切り替える方法を探ります。

- 右上の**個人センター**をクリックし、**「役割を切り替える」**を選択します。
- 「パートナー」役割がリストにすぐに表示されない場合がありますが、心配いりません。ページを**リフレッシュ/キャッシュをクリア**するだけで、役割が表示されるはずです。

![](https://static-docs.nocobase.com/Solution/demov3N-30.gif)

### 6.2 役割にページ権限を割り当てる

「パートナー」役割に切り替えた後、目に見えるページやメニューがないことに気づくかもしれません。これは、まだその役割に特定のページへのアクセス権限を割り当てていないからです。心配しないでください。「パートナー」役割にアクセス権を設定しましょう。

#### 6.2.1 **「パートナー」役割にタスクページ権限を割り当てる**

- まず、**ルート**役割（スーパーユーザー）に切り替え、「**役割と権限**」ページに移動します。
- 「パートナー」役割をクリックして、設定ページを開きます。ここでは、システム内のすべてのページを表す「**メニュー**」タブが表示されます。
- 「**タスク管理**」ページの権限にチェックを入れて、「パートナー」役割にタスク管理ページへのアクセスを許可します。

**個人センターに戻り、再度「パートナー」役割に切り替えると、タスク管理メニューが表示されるはずです。**

![](https://static-docs.nocobase.com/Solution/demov3N-31N.gif)

#### 6.2.2 コレクションのアクションおよび操作権限の設定

「パートナー」役割は現在、タスク管理ページにアクセスできますが、操作権限をさらに制限する必要があります。「パートナー」が以下を行えることを望みます：

- 自分に割り当てられたタスクを**表示および編集**すること、
- タスクの進捗を**更新**すること、
- しかし、**タスクの作成や削除はしないこと**。

これを実現するために、「タスク」の権限を設定します。次に進みましょう！

##### 6.2.2.1 **「パートナー」役割に対するコレクションアクションの権限設定**

- 「**役割と権限**」ページに移動し、「パートナー」役割をクリックして、「**データソース**」タブに切り替えます。
- ここでは、「アクション権限」の設定が表示されます。「タスク」を見つけ、「パートナー」に「表示」「編集」権限を割り当てます。
- 他の役割に「追加」や「削除」の権限を割り当てたくありませんので、最初からこれらを割り当てる必要はありません。

![](https://static-docs.nocobase.com/Solution/demov3N-32.gif)

この時点で「パートナー」役割はタスクデータの表示と編集が可能です。次に、彼らが自分に割り当てられたタスクのみを編集できるようにさらなる制御が必要です。

### 6.3 タスクへの「責任者」フィールドの追加

次に、各タスクに責任者を割り当てます。責任者を指定することで、タスクの責任者のみがタスクを変更でき、他の人は表示のみができるようになります。これを実現するために、**リレーションシップフィールド**を使用して、タスクのコレクションとユーザーのコレクションをリンクします。

#### 6.3.1 **「責任者」フィールドの作成**

1. 「**タスクのコレクション**」に移動し、「**フィールドを追加**」をクリックして、「**リレーションシップフィールド**」を選択します。
2. 「**多対一**」の関係を選択します（各タスクには1人の責任者しかおらず、ユーザーは複数のタスクの責任者になれるため）。
3. フィールドの名前を「**責任者（アサイナー）**」にします。反対の関係を選択する必要はありません。

![](https://static-docs.nocobase.com/Solution/202410262307101729955230.png)

#### 6.3.2 **「責任者」フィールドの表示**

次に、タスク管理ページのコレクションとフォームに「責任者」フィールドが表示されるようにし、各タスクに対して責任者を簡単に割り当てられるようにします。（デフォルトの表示フィールドがIDに設定されている場合は、タイトルフィールドを「ニックネーム」に変更して、名前を表示させます。）

![](https://static-docs.nocobase.com/Solution/202410262311441729955504.png)

### 6.4 **権限管理を使用してアクセスを制御する**

ここで本題です！今、NocoBaseの[**権限管理**](https://docs-cn.nocobase.com/handbook/acl)を使って強力な機能を実装します：**タスクの責任者と作成者だけが編集でき、他の人は表示のみができる**。これがNocoBaseの柔軟性を真に発揮させる場面です。

#### 6.4.1 **簡単な試み — 責任者のみがフォームを編集**

私たちは、タスクの責任者のみが編集できるようにするために、次の条件を設定します：

- 「パートナー」役割のデータコレクション権限に戻り、タスクコレクションの設定を開き、「編集権限」の下の「データ範囲」をクリックします。
- 「責任者が編集できる」カスタムルールを作成します：
  **「責任者/ID」が「現在のユーザー/ID」と等しいときに、編集が許可される；**
  これにより、タスクの責任者のみが編集でき、他の人は表示のみが可能になります。
- 責任者フィールドにユーザーのコレクションを使用しているため、ログインユーザーもユーザーのコレクションにいるので、このルールは最初の要件に完璧に合致します。

追加をクリックし、次に確認します。

![](https://static-docs.nocobase.com/Solution/demov3N-45N.gif)

ページに戻って確認することにしましょう：

素晴らしい！「パートナー」役割に切り替えてページを再度訪問すると、自分が責任者のタスクのみが編集オプションを表示します。

#### 6.4.2 **作成者がフォームを修正するための条件の追加**

新たな問題に気づいたことでしょう：

ほとんどのタスクの責任者ではないため、フォームを編集できず、他の同僚もタスクの詳細を見ることができません！

心配しないでください。「パートナー」役割に対してすべてのデータの「表示」権限を与えたことを覚えていますか？

- ページに戻り、「表示」を選択して、新しい表示操作を追加します。

![](https://static-docs.nocobase.com/Solution/202410270221581729966918.png)

- 編集権限のダイアログと似た表示ダイアログを作成し、「詳細」セクションを選択してください。

![](https://static-docs.nocobase.com/Solution/202410270224221729967062.png)

![](https://static-docs.nocobase.com/Solution/202410270229421729967382.png)

完了です！

### 6.5 **権限制御の検証**

異なるユーザー間で切り替えてフォームを表示すると、フォームセクションがそれぞれのユーザーに許可された操作のみに自動的に調整されることに気づくでしょう。ユーザーの責任があるタスクは編集オプションが表示され、責任がないタスクは表示のみとなります。

ルート役割に戻ると、すべての権限が復元されます。これがNocoBaseの強力な権限制御システムです！

次に、自由にタスクの責任を割り当てられたり、チームメイトを招待してコラボレーションしたりし、設定した権限をテストすることができます。

#### 6.5.1 **新しいユーザーを作成し、役割を割り当てる**

- たとえば、**トム**という新しいユーザーを作成し、**「パートナー」**役割を割り当てます。

![](https://static-docs.nocobase.com/Solution/202410270239121729967952.png)

![](https://static-docs.nocobase.com/Solution/202410270242581729968178.png)

- タスク管理ページでいくつかのタスクを**トム**に割り当てます。

#### 6.5.2 **ログインテスト**

トムにシステムにログインさせて、割り当てられたタスクを見ることができ、編集できるかを確認します。設定した権限ルールに基づき、トムは責任のあるタスクのみを編集できるはずで、他のタスクは閲覧専用になります。

すべてのページの編集フォーム権限は正しく同期されました！

---

### まとめ

おめでとうございます！これまでの学習を通じて、NocoBaseで役割を作成し、権限を割り当て、カスタム権限を設定し、チームメンバーが自分に割り当てられたタスクだけを編集できるようにしました。こうして、チームコラボレーションのための明確で整理された権限管理システムを確立しました。

### チャレンジタスク

現在、トムは自分に割り当てられたタスクを表示して編集できますが、彼が**コメントを残すことができない**、タスクのディスカッションに参加できないことに気づくかもしれません。では、トムが自由にコメントし、ディスカッションに参加できるようにするためにはどうすればいいのでしょうか？これは興味深い課題です！

**チャレンジヒント：**

役割の権限設定に戻り、「パートナー」役割を調整し、コレクション設定を見直して、トムにコメントの権限を付与しながら、他のタスクの制限を維持できるようにする方法を探してみてください。

試してみてください！その解決策は次のセクションで発表します。

次の章では、「チームメンバーの活動」を実装し、もう一つの強力なモジュール[**ワークフロー**](https://docs-nocobase.com/handbook/workflow)を紹介します。ワークフローを使用すると、データの流れを促進し、さまざまなアクションをトリガーし、システム内の複雑な業務プロセスを自動化できます。探索を続ける準備はできていますか？[第7章：ワークフロー](https://www.nocobase.com/en/blog/task-tutorial-workflow)でお会いしましょう！

---

さらに探求し、創造性を発揮してください！問題が発生した場合は、[NocoBase公式ドキュメント](https://docs.nocobase.com/)をチェックするか、[NocoBaseコミュニティ](https://forum.nocobase.com/)に参加して議論してください。
