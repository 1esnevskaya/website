チームコラボレーションにおいて、全員が自分の役割と権限を明確に理解することが重要です。これにより、スムーズな進行が保証されます。本日は、役割の作成と権限管理について学び、チームワークをより円滑で整理されたものにしていきます。

心配しないでください。このプロセスはシンプルで、各重要なステージでガイドを行います。問題が発生した場合は、公式フォーラムにご連絡ください。

### 要件分析

タスク管理に参加するための「パートナー」役割が必要でしたが、他人のタスクを自由に変更することはできません。このアプローチにより、タスクを割り当て、柔軟にコラボレーションができるようになります。

![役割構造図](https://static-docs.nocobase.com/Solution/WSy8bi0zOozbBKxzlimcyje4n7f.png)

> **役割と権限の紹介:** 役割と権限は、ユーザーアクセスと操作を管理するための重要なメカニズムです。各ユーザーは複数の役割を持つことができます。
>
> 役割の権限を設定することで、システム内でのユーザーの行動や操作を制御し、表示される機能を制限することが重要で、アクセス制御に役立ちます。
> 役割と権限を使用してユーザーをバインドすることで、システムをより効果的に管理できます。管理者として、必要に応じて権限を割り当てたり調整したりできます。

### 6.1 **役割の作成と割り当て**

#### 6.1.1 **「パートナー」役割の作成**

- インターフェースの右上にある [「ユーザーと権限」](https://docs.nocobase.com/handbook/users) をクリックし、 [「役割と権限」](https://docs.nocobase.com/handbook/acl) を選択します。ここで役割を構成し、権限を管理します。
- [「役割を作成」](https://docs.nocobase.com/handbook/users) ボタンをクリックすると、ダイアログボックスが表示されます。ここで役割を **パートナー** と名付け、保存を確認します。

![](https://static-docs.nocobase.com/Solution/demov3N-28N.gif)

新しい役割が成功裏に作成されました！次に、この役割に権限を割り当て、タスク管理に参加できることを確認する必要があります。

#### 6.1.2 **自分に新しい役割を割り当てる**

役割権限が正常に機能することを確認するために、まずこの役割を自分のアカウントに割り当ててテストします。操作は簡単です。

- ユーザー管理セクションで自分のアカウントを見つけ、クリックして選択し、「**役割と権限**」を選択し、「**パートナー**」を選択します。

![](https://static-docs.nocobase.com/Solution/demov3N-29.gif)

これで、自分のアカウントを使って「パートナー」役割をシミュレートできます。次に、役割を切り替える方法を見てみましょう。

#### 6.1.3 **「パートナー」役割への切り替え**

自分に「パートナー」役割を割り当てたので、役割を切り替える方法を探ります。

- 右上隅の **個人センター** をクリックし、「**役割を切り替える**」を選択します。
- リストに「パートナー」役割がすぐに表示されないことに気付くかもしれませんが、心配しないでください。ページを**更新する/キャッシュをクリア**することで、役割が表示されるはずです。

![](https://static-docs.nocobase.com/Solution/demov3N-30.gif)

### 6.2 役割にページ権限を割り当てる

「パートナー」役割に切り替えたら、目に見えるページやメニューがないことに気付くかもしれません。これは、まだ特定のページにアクセスするための権限を割り当てていないためです。問題ありません。「パートナー」役割のアクセス権限を設定しましょう。

#### 6.2.1 **「パートナー」役割にタスクページ権限を割り当てる**

- まず、**Root** 役割（スーパー管理者）に戻り、「**役割と権限**」ページに移動します。
- 「パートナー」役割をクリックして構成ページを開きます。ここでは、「**メニュー**」タブが表示され、システム内のすべてのページを表します。
- 「**タスク管理**」ページ権限にチェックを入れて、「パートナー」役割がタスク管理ページにアクセスできるようにします。

次に **個人センター** に戻り、「パートナー」役割に再度切り替えると、タスク管理メニューのページを見えるようになるはずです。

![](https://static-docs.nocobase.com/Solution/demov3N-31N.gif)

#### 6.2.2 コレクションアクションと操作権限の設定

「パートナー」役割がタスク管理ページにアクセスできるようになったので、操作権限をさらに制限する必要があります。「パートナー」は次のことができるようにしてください：

- **自分に割り当てられた**タスクの**表示と編集**ができる。
- **タスクの進捗を更新**できる。
- しかし、**タスクを作成または削除**することはできない。

これを実現するためには、「タスク」の権限を設定する必要があります。それでは、進めましょう！

##### 6.2.2.1 **「パートナー」役割のコレクションアクション権限を設定する**

- 「**役割と権限**」ページに移動し、「パートナー」役割をクリックし、「**データソース**」タブに切り替えます。
- ここには「アクション権限」の設定があります。「**タスク**」を見つけて、「パートナー」に「表示」および「編集」権限を付与します。
- 新しいタスクタイプや削除タスク権限を他の役割に付与しないので、これらの権限を初めから付与する必要はありません。

![](https://static-docs.nocobase.com/Solution/demov3N-32RN1.gif)

![demov3N-32RN2.gif](https://static-docs.nocobase.com/Solution/demov3N-32RN2.gif)

この時点で、「パートナー」役割はタスクデータを表示および編集する権限を持っています。次は、タスクを自分に割り当てるだけで編集ができるようにするさらなる制御が必要です。

### 6.3 タスクに「責任者」フィールドを追加する

次に、各タスクに責任者を割り当てます。責任者を指定することで、タスクの責任者のみがタスクを変更できることを保証し、他の人はそれを表示できるようになります。これを実現するために、タスクコレクションとユーザコレクションをリンクするために**関係フィールド**を使用します。

#### 6.3.1 **「責任者」フィールドの作成**

1. 「**タスクコレクション**」に移動し、「**フィールドを追加**」をクリックして「**関係フィールド**」を選択します。
2. 「**多対一**」関係を選択します（各タスクには責任者が一人しかいないため、一人のユーザーが複数のタスクを担当できます）。
3. フィールドに「**責任者（アサイナー）**」と名付けます。今のところ逆の関係を選択する必要はありません。

![](https://static-docs.nocobase.com/Solution/202410262307101729955230.png)

#### 6.3.2 **「責任者」フィールドの表示**

次に、タスク管理ページのコレクションとフォームで「責任者」フィールドが表示されるようにし、各タスクに責任者を簡単に割り当てられるようにします。（フィールドがデフォルトでIDを表示する場合は、単にタイトルフィールドを「ニックネーム」に変更して名前を表示します。）

![](https://static-docs.nocobase.com/Solution/202410262311441729955504.png)

### 6.4 **権限管理**でアクセスを制御する

注目のセクションです！これで、NocoBaseの[**権限管理**](https://docs-cn.nocobase.com/handbook/acl)を使用して、次の強力な機能を実装します。**タスクの責任者と作成者のみが編集できる**、他の人は表示のみ可能です。これがNocoBaseの真の柔軟性です。

#### 6.4.1 **簡単な試み — 責任者のみがフォームを編集できる**

タスクの責任者のみがタスクを編集できるようにしたいので、次の条件を設定します：

- 「パートナー」役割のデータコレクション権限に戻り、タスクコレクションの設定を開き、「編集権限」の下で「データスコープ」をクリックします。
- 「責任者が編集できる」と名付けたカスタムルールを作成します：
  **「責任者/ID」が「現在のユーザー/ID」と等しい場合、** 編集が許可されます；
  つまり、タスクの責任者のみが編集でき、他の人はそれを表示できるのです。
- 責任者フィールドにはユーザーコレクションを使用しており、ログインしているユーザーもユーザーコレクションにいるため、このルールは初期要件を完璧に満たします。

追加して、確認をクリックします。

![](https://static-docs.nocobase.com/Solution/demov3N-45N.gif)

さあ、ページに戻って確認してみましょう。

完璧です！「パートナー」役割に切り替えてページに戻ると、責任者であるタスクのみが編集オプションを表示します。

#### 6.4.2 **作成者がフォームを変更できる条件を追加**

新しい問題がすぐに見つかるかもしれません：

ほとんどのタスクに対して責任者ではないため、私たちはフォームを編集できず、他の同僚もタスクの詳細を表示できません！

心配しないでください。以前に「パートナー」役割にすべてのデータの**表示権限**を割り当てましたよね？

- ページ構成に戻り、表示を選択して表示操作を追加します。

![](https://static-docs.nocobase.com/Solution/202410270221581729966918.png)

- 編集権限ダイアログのレイアウトと似た表示ダイアログを作成し、「詳細」セクションを選択してください。

![](https://static-docs.nocobase.com/Solution/202410270224221729967062.png)

![](https://static-docs.nocobase.com/Solution/202410270229421729967382.png)

できました！

### 6.5 **権限制御の検証**

異なるユーザー間で切り替えてフォームを表示すると、フォームセクションが自動的に調整され、各ユーザーに許可されている操作のみが表示されます。ユーザーが責任を持つすべてのタスクは編集オプションを表示し、責任がないタスクは表示オプションのみを示します。

Root役割に戻ると、すべての権限が復元されます。これがNocoBaseの強力な権限制御システムです！

次に、タスク責任者を自由に割り当て、チームメンバーを招待してコラボレーションを行い、設定した権限をテストすることができます。

#### 6.5.1 **新しいユーザーを作成し、役割を割り当てる**

- 新しいユーザーを作成します。例えば、「トム」という名前のユーザーを作成し、[「パートナー」](https://docs.nocobase.com/handbook/users)役割を割り当てます。

![](https://static-docs.nocobase.com/Solution/202410270239121729967952.png)

![](https://static-docs.nocobase.com/Solution/202410270242581729968178.png)

- タスク管理ページで、いくつかのタスクを**トム**に割り当てます。

#### 6.5.2 **ログインテスト**

トムにシステムにログインさせて、割り当てられたタスクを表示および編集できるか確認します。設定した権限ルールに基づき、トムは自分が責任を持つタスクしか編集できません。他のタスクはすべて読み取り専用です。

すべてのページで編集フォームの権限が正常に同期されました！

---

### まとめ

おめでとうございます！これまでに、NocoBaseで役割を作成し、権限を割り当て、カスタム権限を設定し、チームメンバーが自らに割り当てられたタスクのみを編集できるようにする方法を学びました。これらのステップを通じて、チームコラボレーションのための明確で整理された権限管理システムを確立しました。

### 挑戦タスク

現在、トムは自分に割り当てられたタスクを表示および編集できますが、**コメントを残すことができない**ことに気付くかもしれません。トムが自由にコメントでき、タスクディスカッションに参加できるようにするにはどうすればよいでしょうか？これは非常に興味深い挑戦になるでしょう！

**挑戦のヒント：**

役割権限設定に戻って「パートナー」役割を調整して、トムのコメント権限をどのように設定し、他のタスクの制限が維持できるかを確認できます。

挑戦してみてください！次のセクションで解決策を示します。

次の章では、「チームメンバーの活動」機能を実装し、もう一つの強力なモジュール「**ワークフロー**」の紹介を行います。ワークフローを利用することで、データフローを有効にし、さまざまな動作をトリガーし、システム内の複雑なビジネスプロセスを自動化することができます。引き続き探求する準備はできましたか？「第7章：ワークフロー」にお会いしましょう！